!function(){"use strict";function e(e,i){getUserGists(e,(function(e,s){s?($(".gist-list-container").hide(),$("#error-text").text(JSON.stringify(s,null,2)),$(".error-display").show(),i&&i(!1)):($(".error-display").hide(),buildGistList($("#gist-list"),e,t),$(".gist-list-container").show(),i&&i(!0))}))}function t(){$(".ms-ListItem").removeClass("is-selected").removeAttr("checked"),$(this).children(".ms-ListItem").addClass("is-selected").attr("checked","checked"),$(".not-configured-warning").hide(),$("#settings-done").removeAttr("disabled")}function i(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}Office.initialize=function(t){jQuery(document).ready((function(){if(window.location.search)if(i("warn"))$(".not-configured-warning").show();else{var t=i("gitHubUserName"),s=i("defaultGistId");$("#github-user").val(t),e(t,(function(e){e&&($(".ms-ListItem").removeClass("is-selected"),$("input").filter((function(){return this.value===s})).addClass("is-selected").attr("checked","checked"),$("#settings-done").removeAttr("disabled"))}))}$("#github-user").on("change",(function(){$("#gist-list").empty();var t=$("#github-user").val();t.length>0&&e(t)})),$("#settings-done").on("click",(function(){var e={};e.gitHubUserName=$("#github-user").val();var t,i=$(".ms-ListItem.is-selected");i&&(e.defaultGistId=i.val(),t=JSON.stringify(e),Office.context.ui.messageParent(t))}))}))}}();
//# sourceMappingURL=dialog.js.map